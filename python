version_new = "2.1.4"      # Phiên bản mới (giả định)

def compare_versions(version_current, version_new):
    try:
        # Chuyển đổi phiên bản thành danh sách số nguyên để dễ so sánh
        current_parts = list(map(int, version_current.split(".")))
        new_parts = list(map(int, version_new.split(".")))

        # So sánh từng phần tử của phiên bản
        if new_parts > current_parts:
            messagebox.showinfo("Plants Vs Zombies Dung Hợp", f"Phiên bản mới ({version_new}) lớn hơn phiên bản hiện tại ({version_current}).")
        elif new_parts < current_parts:
            messagebox.showinfo("Plants Vs Zombies Dung Hợp", f"Phiên bản hiện tại ({version_current}) đã lớn hơn phiên bản mới ({version_new}).")
        else:
            messagebox.showinfo("Plants Vs Zombies Dung Hợp", "Đúng Phiên Bản.")
    except ValueError:
        messagebox.showerror("Lỗi", "Định dạng phiên bản không hợp lệ.")
    except Exception as e:
        messagebox.showerror("Lỗi không xác định", f"Đã xảy ra lỗi: {e}")

# Thay thế Client ID của bạn ở đây
client_id = '1305854246142476299'
rpc = Presence(client_id)  # Khởi tạo client Rich Presence

def connect_discord_rpc():
    try:
        rpc.connect()
        print("Đã kết nối tới Discord")
        return True
    except Exception as e:
        print(f"Không thể kết nối Discord Rich Presence: {e}")
        return False

def set_rich_presence():
    try:
        # Cập nhật trạng thái Rich Presence
        rpc.update(
            details="PVZ Fusion Việt Hóa By CBD Team",  # Mô tả hiện tại
            start=time.time(),  # Thời gian bắt đầu thực
            large_image="embedded_background",  # Key của hình ảnh lớn (phải được tải lên Discord)
            large_text="LanPiaoPiao (BlueFly)",  # Văn bản khi di chuột vào ảnh lớn
            party_id="ae488379-351d-4a4f-ad32-2b9b01c91657",  # ID của nhóm (nếu có)
            join="MTI4NzM0OjFpMmhuZToxMjMxMjM="  # Chuỗi bí mật để tham gia
        )
        print("Rich Presence đã được thiết lập.")
    except Exception as e:
        print(f"Không thể thiết lập Rich Presence: {e}")

def is_pvz_running():
    # Kiểm tra xem tiến trình "PlantsVsZombiesRH.exe" có đang chạy không
    for proc in psutil.process_iter(['pid', 'name']):
        print(f"Đang kiểm tra tiến trình: {proc.info['name']}")  # In ra tên tiến trình để kiểm tra
        if proc.info['name'] == 'PlantsVsZombiesRH.exe':
            return True
    return False

def check_pvz_process():
    # Kiểm tra và in ra trạng thái của tiến trình "PlantsVsZombiesRH.exe"
    while is_pvz_running():
        time.sleep(1)  # Dừng lại một giây trước khi kiểm tra lại


# So sánh phiên bản sau khi tạo cửa sổ
compare_versions(version_current, version_new)
